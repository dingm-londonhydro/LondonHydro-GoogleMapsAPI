<div id="map_canvas"></div>
<script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false"></script>
<script src="../js/moment.js"></script>
<script>
var placemarkArray = [];
    var xmlRequest = new XMLHttpRequest();
    xmlRequest.open("GET","http://mding5692.github.io/LondonHydro-GoogleMapsAPI/outages.kml", false);
    xmlRequest.send();
    
    xmlDoc=xmlRequest.responseXML;
    var x=xmlDoc.getElementsByTagName("Placemark");
    var date_format = "MMM DD, hh:mm a";
    
    var i = 0;
    // gets the event number
    var event_number_value = x[i].getElementsByTagName("SimpleData")[2].childNodes[0].nodeValue;
    // gets outage start time
    var outage_time_value = x[i].getElementsByTagName("SimpleData")[3].childNodes[0].nodeValue;
    var outage_time_moment = moment(outage_time_value);
    // converts to humanly readable form
    var outage_time = outage_time_moment.format(date_format);
    // copy down the coordinates
    // gets estimated restoration time
    var restoration_time_value = x[i].getElementsByTagName("SimpleData")[5].childNodes[0].nodeValue;
        if (restoration_time_value === "2001-01-01T00:00:00") {
        var restoration_time = "Not yet determined";
        } else {
        var restoration_time_moment = moment(restoration_time_value);
        
        // converts to humanly readable form
        var restoration_time = restoration_time_moment.format(date_format);
        }
        // gets the coordinates of the polygon
        var coords = x[i].getElementsByTagName("coordinates")[0].childNodes[0].nodeValue;
        var coordinate = coords.split(",0 ");
        // gets the colour of the polygon
        var colour = x[i].getElementsByTagName("styleUrl")[0].childNodes[0].nodeValue;
        var fillColour, borderColour;
        
        // determines the colour
        if (colour === "#Style1") {
        fillColour = '7f4cf5fc';
        borderColour = 'ff4cf5fc';
        } else if (colour === "#Style2") {
        fillColour = '7f3293f0';
        borderColour = 'ff3293f0';
        } else {
        fillColour = '7fc98bb4';
        borderColour = 'ffc98bb4';
        }
        
        // adds to JSON object in JSON array
        var obj = {
        event_number: event_number_value,
        off_time: outage_time,
        restore_time: restoration_time,
        fill: fillColour,
        border: borderColour,
        coordinates: coords
        };
        
        // see this http://stackoverflow.com/questions/21663167/google-maps-api-latlng-returning-nan

        // http://stackoverflow.com/questions/16834311/use-of-mvc-array-when-creating-polygon

        //http://stackoverflow.com/questions/6593473/lat-long-array-as-markers-on-google-maps-api-v3

        var firstCoords = [];
        var secondCoords = [];

        document.write(coordinate);

        /*// use coordinate array
        for (var count = 0; count < coordinate.length; count++) {

            // move to next 
            var current = coordinate[count];

            // then convert to float
            var converted = parseFloat(current);

            // move to first array if count is odd
            if ((count%2) != 0 ) {
                firstCoords.push(converted);
            } else {
                secondCoords.push(converted);
            }

        }

        document.write(firstCoords);
        document.write(secondCoords);
        // convert to float

        // then move to separate arrays



   /*     var coord2DArray = Array();

        var j = 0; 
        while (j<coordinate.length) {
            // add in an array of two coordinate
            // add array of first coord and then second coord
            coord2DArray[j] = ;
        }

*/

</script>
